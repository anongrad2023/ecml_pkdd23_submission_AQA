{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"collapsed_sections":["ybu8iEZskb-3","0fSMAjHpkb-4","glKP3nrhkb-6","Df9iIZyhkb--","tzRLOi-Jkb-_","TBwBOc1LJWSS","YEniTxLUPL-K","zUUz0lb2yLAg","Ee2A1EDh0Zgd","rPCF7MZNzOAT"],"toc_visible":true,"machine_shape":"hm","authorship_tag":"ABX9TyMvXtgobrsViIFkaxE3PU7x"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","gpuClass":"premium","widgets":{"application/vnd.jupyter.widget-state+json":{"2f943c0859294f1996ad7446d59f9875":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_5c49585ec04b4e959982da7fa03c9b95","IPY_MODEL_b8d1018966384ba48b1a169eedf17e3c","IPY_MODEL_6887223f465d4ed78b9e73f86a4c4b63"],"layout":"IPY_MODEL_3adfd4fffe544b48b50b4930ef78b662"}},"5c49585ec04b4e959982da7fa03c9b95":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2bb05b51a59a402ea6e32e466ee7a942","placeholder":"​","style":"IPY_MODEL_b83fed0069ee4b3ca9bbe71042239c82","value":"Downloading (…)solve/main/vocab.txt: 100%"}},"b8d1018966384ba48b1a169eedf17e3c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f2df3a3edf7e42499d01e93e621a89c0","max":231508,"min":0,"orientation":"horizontal","style":"IPY_MODEL_121d4e9a162c4a2797c56ba5c6d71e86","value":231508}},"6887223f465d4ed78b9e73f86a4c4b63":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b95c944996ba4c9abb1f2e4088d075f1","placeholder":"​","style":"IPY_MODEL_105d3923ec684dbf827233d47029b850","value":" 232k/232k [00:00&lt;00:00, 2.89MB/s]"}},"3adfd4fffe544b48b50b4930ef78b662":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2bb05b51a59a402ea6e32e466ee7a942":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b83fed0069ee4b3ca9bbe71042239c82":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f2df3a3edf7e42499d01e93e621a89c0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"121d4e9a162c4a2797c56ba5c6d71e86":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b95c944996ba4c9abb1f2e4088d075f1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"105d3923ec684dbf827233d47029b850":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"179820f6f0764af8ab1413582f4048cc":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_bc70b8450e034b959ee624f6b75fa3d6","IPY_MODEL_5ec94cfec05746a0bccd6f82ad4c1c85","IPY_MODEL_23f577fd22ee41d59bf092508073021a"],"layout":"IPY_MODEL_54717c8413a942c48e2cb291534261e0"}},"bc70b8450e034b959ee624f6b75fa3d6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_80e716264d644641b2d13056b2a38126","placeholder":"​","style":"IPY_MODEL_d7ebc157aaae49669c7533ebee031593","value":"Downloading (…)okenizer_config.json: 100%"}},"5ec94cfec05746a0bccd6f82ad4c1c85":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_94f36e0156e54f24aed2a7ea20f85d5d","max":28,"min":0,"orientation":"horizontal","style":"IPY_MODEL_7d88b19ad73c4037924284b4bc46b641","value":28}},"23f577fd22ee41d59bf092508073021a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9c3c18998b034acaba202634c7dc7fd3","placeholder":"​","style":"IPY_MODEL_e042abad39d34daaaf3e7b939d360641","value":" 28.0/28.0 [00:00&lt;00:00, 1.91kB/s]"}},"54717c8413a942c48e2cb291534261e0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"80e716264d644641b2d13056b2a38126":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d7ebc157aaae49669c7533ebee031593":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"94f36e0156e54f24aed2a7ea20f85d5d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7d88b19ad73c4037924284b4bc46b641":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9c3c18998b034acaba202634c7dc7fd3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e042abad39d34daaaf3e7b939d360641":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f9be60d9eb534f50bda80f7ef7da90c3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_86b85dbf44fa4b9d8912a0b36863d5ce","IPY_MODEL_719c951928544d039d1fda28bac198ab","IPY_MODEL_f594185c6e814986bb3c37219ba9b1c1"],"layout":"IPY_MODEL_fef2ec84633d43939435963de8dff140"}},"86b85dbf44fa4b9d8912a0b36863d5ce":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_aeb729c9a3f34e39ac3002135b42e02e","placeholder":"​","style":"IPY_MODEL_dc917ddda459402d95bb7f714b2b403b","value":"Downloading (…)lve/main/config.json: 100%"}},"719c951928544d039d1fda28bac198ab":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4dd0f6e187084367b49062dec1889cfa","max":483,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b27d4b0474c642f287e04cd4740e9fd5","value":483}},"f594185c6e814986bb3c37219ba9b1c1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_37b3e1a2d20d4722920f3f245b285198","placeholder":"​","style":"IPY_MODEL_19d677424420449484d7e45c381a8bdd","value":" 483/483 [00:00&lt;00:00, 36.2kB/s]"}},"fef2ec84633d43939435963de8dff140":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"aeb729c9a3f34e39ac3002135b42e02e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dc917ddda459402d95bb7f714b2b403b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4dd0f6e187084367b49062dec1889cfa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b27d4b0474c642f287e04cd4740e9fd5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"37b3e1a2d20d4722920f3f245b285198":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"19d677424420449484d7e45c381a8bdd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"557bab4cebd445f9a347b5f9f85e8e91":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6291af4dc6d0464f8134a61d5c015cd9","IPY_MODEL_6f08df3f02984f0183c51de3310b1574","IPY_MODEL_64a99dd2253c47db941a4fb4559e0d71"],"layout":"IPY_MODEL_146e23d91d4c4076b45255bc5df69b72"}},"6291af4dc6d0464f8134a61d5c015cd9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c012b83969874e99a322629837530dbb","placeholder":"​","style":"IPY_MODEL_805e5a5e937843ad9988b57853b235c9","value":"Downloading (…)&quot;pytorch_model.bin&quot;;: 100%"}},"6f08df3f02984f0183c51de3310b1574":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_554b3236be944ae2b6ac720bc6987ca3","max":267967963,"min":0,"orientation":"horizontal","style":"IPY_MODEL_7e3a65b7d4a14f4cb3f05234739608cd","value":267967963}},"64a99dd2253c47db941a4fb4559e0d71":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d2a9eb758dad44ebb50b84adabf1fc81","placeholder":"​","style":"IPY_MODEL_524351ac728d4c6a8cc5bb8a6701ee41","value":" 268M/268M [00:02&lt;00:00, 137MB/s]"}},"146e23d91d4c4076b45255bc5df69b72":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c012b83969874e99a322629837530dbb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"805e5a5e937843ad9988b57853b235c9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"554b3236be944ae2b6ac720bc6987ca3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7e3a65b7d4a14f4cb3f05234739608cd":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d2a9eb758dad44ebb50b84adabf1fc81":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"524351ac728d4c6a8cc5bb8a6701ee41":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"648ff2a4b4b840bcb7129368ef3140b9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_88f7146f4d574bc5a6b40446e12579e5","IPY_MODEL_51381d31a49c47aa842522be68ba4338","IPY_MODEL_1e5dcfd07a9f4efdb2a241a0a3d1066b"],"layout":"IPY_MODEL_e3d9b69995bc4526836ce2b2ac4784fe"}},"88f7146f4d574bc5a6b40446e12579e5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ed49d4e1960448dcaab2d1b6d1ebdfe8","placeholder":"​","style":"IPY_MODEL_183d90021b6e4973bb875aa9b653becf","value":"100%"}},"51381d31a49c47aa842522be68ba4338":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1ece6f4e46774b6dbd57ba67bf49989d","max":100,"min":0,"orientation":"horizontal","style":"IPY_MODEL_02c9083835b344f3a8f3f401ebebc066","value":100}},"1e5dcfd07a9f4efdb2a241a0a3d1066b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7570902ff9b64e00adc1bb8b81d4aad7","placeholder":"​","style":"IPY_MODEL_e4b2a5b122bf4c25b0790440b061043e","value":" 100/100 [53:15&lt;00:00, 31.92s/epoch]"}},"e3d9b69995bc4526836ce2b2ac4784fe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ed49d4e1960448dcaab2d1b6d1ebdfe8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"183d90021b6e4973bb875aa9b653becf":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1ece6f4e46774b6dbd57ba67bf49989d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"02c9083835b344f3a8f3f401ebebc066":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7570902ff9b64e00adc1bb8b81d4aad7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e4b2a5b122bf4c25b0790440b061043e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"AbeAB8Hokb-2"},"source":["# Setup"]},{"cell_type":"markdown","metadata":{"id":"ybu8iEZskb-3"},"source":["## Imports"]},{"cell_type":"code","execution_count":1,"metadata":{"id":"JiAEt7P6kb-3","executionInfo":{"status":"ok","timestamp":1674767033561,"user_tz":300,"elapsed":4232,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"outputs":[],"source":["import os\n","import numpy as np\n","import pandas as pd\n","from sklearn.model_selection import train_test_split\n","from sklearn.linear_model import LogisticRegression\n","from sklearn.model_selection import GridSearchCV\n","from sklearn.model_selection import cross_val_score\n","import torch\n","import random\n","import warnings\n","warnings.filterwarnings('ignore')\n","\n","from tqdm.notebook import tqdm\n","import pickle"]},{"cell_type":"markdown","metadata":{"id":"0fSMAjHpkb-4"},"source":["## Constants"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"UNU4HLNZkb-5","executionInfo":{"status":"ok","timestamp":1674767033562,"user_tz":300,"elapsed":8,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"outputs":[],"source":["RESULTS_FN_SLUG = \"AQA06_01_results\"\n","\n","GCS_APP_ID = \"aqa-research\"\n","GCS_BUCKET = \"dabi-aqa-data-00\"\n","\n","FN_QUESTIONS = \"questions_01.csv\"\n","FN_CONTEXTS  = \"contexts_01.csv\"\n","\n","FN_A2_RAW = \"a2_raw.csv\"\n","FN_A2_FA  = \"a2_gs.csv\"\n","FN_A3_FA  = \"a3_gs.csv\"\n","FN_A3_MAJ = \"a3_con.csv\"\n","\n","MAX_SEQ_LEN = 128\n","\n","EPOCHS = 100\n","BATCH_SIZE = 16\n","TEST_FRAC = 0.1\n","\n","RAND_SEED = 4242"]},{"cell_type":"markdown","metadata":{"id":"glKP3nrhkb-6"},"source":["## GCS Auth - Input Needed"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12074,"status":"ok","timestamp":1674767045630,"user":{"displayName":"Bill Power","userId":"17299628813846429758"},"user_tz":300},"id":"xwxl9-b4kb-7","outputId":"5ddf8fd5-ac8e-46f9-f78b-854d6b4892aa"},"outputs":[{"output_type":"stream","name":"stdout","text":["Go to the following link in your browser:\n","\n","    https://accounts.google.com/o/oauth2/auth?response_type=code&client_id=32555940559.apps.googleusercontent.com&redirect_uri=https%3A%2F%2Fsdk.cloud.google.com%2Fauthcode.html&scope=openid+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcloud-platform+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fappengine.admin+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fsqlservice.login+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcompute+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Faccounts.reauth&state=eRD6gCU3fUr1SJewia6eRcFf3NMxYw&prompt=consent&access_type=offline&code_challenge=AlH-GwO959dV0IELNfE6ekKCAt30qerZBoe9D5QDyxw&code_challenge_method=S256\n","\n","Enter authorization code: 4/0AWtgzh7jkHD1GLMcjSfAZqR3NPYl0Ol6I6cjxraSj6-nQmkFtVigGkenecseEjNiBREf1g\n","\n","You are now logged in as [willpowe@gmail.com].\n","Your current project is [None].  You can change this setting by running:\n","  $ gcloud config set project PROJECT_ID\n"]}],"source":["!gcloud auth login --launch-browser"]},{"cell_type":"code","execution_count":4,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":845,"status":"ok","timestamp":1674767046468,"user":{"displayName":"Bill Power","userId":"17299628813846429758"},"user_tz":300},"id":"SEQdfjlikb-7","outputId":"bc18a946-dcfe-4121-ba1d-9060e268acd1"},"outputs":[{"output_type":"stream","name":"stdout","text":["Updated property [core/project].\n"]}],"source":["!gcloud config set project {GCS_APP_ID}"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"1x_hDs2gkb-8","executionInfo":{"status":"ok","timestamp":1674767046470,"user_tz":300,"elapsed":26,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"outputs":[],"source":["def download_file_from_gcs(src_fn, dest_fn):\n","  dest = f\"/content/{dest_fn}\"\n","  dl_command = f\"gsutil -m cp gs://{GCS_BUCKET}/{src_fn} {dest}\"\n","  os.system(dl_command)\n","\n","def upload_file_to_gcs(src_fn, dest_fn):\n","  dest_url = \"{}/{}\".format(GCS_BUCKET, dest_fn)\n","  ul_command = \"gsutil -m cp {} gs://{}\".format(src_fn, dest_url)\n","  os.system(ul_command)"]},{"cell_type":"markdown","metadata":{"id":"Df9iIZyhkb--"},"source":["## Raw Data"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"YOIG4PnXkb-_","executionInfo":{"status":"ok","timestamp":1674767057812,"user_tz":300,"elapsed":11362,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"outputs":[],"source":["download_file_from_gcs(FN_QUESTIONS, FN_QUESTIONS)\n","download_file_from_gcs(FN_CONTEXTS, FN_CONTEXTS)\n","\n","download_file_from_gcs(FN_A2_RAW, FN_A2_RAW)\n","download_file_from_gcs(FN_A2_FA, FN_A2_FA)\n","download_file_from_gcs(FN_A3_FA, FN_A3_FA)\n","download_file_from_gcs(FN_A3_MAJ, FN_A3_MAJ)"]},{"cell_type":"markdown","metadata":{"id":"tzRLOi-Jkb-_"},"source":["## BERT Setup"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9529,"status":"ok","timestamp":1674767067318,"user":{"displayName":"Bill Power","userId":"17299628813846429758"},"user_tz":300},"id":"C_lWu_g_kb_A","outputId":"81fae253-7ffd-4eb9-813e-0f300b0609ef"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.26.0-py3-none-any.whl (6.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m6.3/6.3 MB\u001b[0m \u001b[31m54.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.8/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.8/dist-packages (from transformers) (3.9.0)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.8/dist-packages (from transformers) (1.21.6)\n","Requirement already satisfied: requests in /usr/local/lib/python3.8/dist-packages (from transformers) (2.25.1)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1\n","  Downloading tokenizers-0.13.2-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.6 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.6/7.6 MB\u001b[0m \u001b[31m106.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.8/dist-packages (from transformers) (4.64.1)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.8/dist-packages (from transformers) (2022.6.2)\n","Collecting huggingface-hub<1.0,>=0.11.0\n","  Downloading huggingface_hub-0.12.0-py3-none-any.whl (190 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m190.3/190.3 KB\u001b[0m \u001b[31m23.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.8/dist-packages (from transformers) (21.3)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.8/dist-packages (from huggingface-hub<1.0,>=0.11.0->transformers) (4.4.0)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.8/dist-packages (from packaging>=20.0->transformers) (3.0.9)\n","Requirement already satisfied: chardet<5,>=3.0.2 in /usr/local/lib/python3.8/dist-packages (from requests->transformers) (4.0.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.8/dist-packages (from requests->transformers) (2022.12.7)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.8/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.8/dist-packages (from requests->transformers) (2.10)\n","Installing collected packages: tokenizers, huggingface-hub, transformers\n","Successfully installed huggingface-hub-0.12.0 tokenizers-0.13.2 transformers-4.26.0\n"]}],"source":["!pip install transformers"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"VA_ZnC0dkb_A","executionInfo":{"status":"ok","timestamp":1674767069677,"user_tz":300,"elapsed":2377,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"outputs":[],"source":["import transformers as ppb"]},{"cell_type":"markdown","source":["## Random Seeds"],"metadata":{"id":"TBwBOc1LJWSS"}},{"cell_type":"code","source":["random.seed(RAND_SEED)\n","np.random.seed(RAND_SEED)\n","torch.manual_seed(RAND_SEED)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HNrkkYVqJV62","executionInfo":{"status":"ok","timestamp":1674767069679,"user_tz":300,"elapsed":14,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}},"outputId":"75ffd78c-805a-424b-c1c2-38e871472f0f"},"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<torch._C.Generator at 0x7f9d1fd60170>"]},"metadata":{},"execution_count":9}]},{"cell_type":"markdown","metadata":{"id":"YEniTxLUPL-K"},"source":["# Data"]},{"cell_type":"markdown","source":["## Content Dataframes"],"metadata":{"id":"zUUz0lb2yLAg"}},{"cell_type":"code","execution_count":10,"metadata":{"id":"WuLRs3tXkb_C","executionInfo":{"status":"ok","timestamp":1674767088470,"user_tz":300,"elapsed":339,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"outputs":[],"source":["questions = pd.read_csv(FN_QUESTIONS)\n","contexts  = pd.read_csv(FN_CONTEXTS)\n","\n","content_a2_raw = pd.read_csv(FN_A2_RAW)\n","content_a2_fa  = pd.read_csv(FN_A2_FA)\n","content_a3_fa  = pd.read_csv(FN_A3_FA)\n","content_a3_maj = pd.read_csv(FN_A3_MAJ)\n","\n","content_a3_majplus = pd.concat([content_a3_fa, content_a3_maj])"]},{"cell_type":"markdown","metadata":{"id":"kNQBRgQkkb_B"},"source":["## Transformer Init\n","\n"]},{"cell_type":"code","execution_count":11,"metadata":{"id":"wrotnPAHkb_C","colab":{"base_uri":"https://localhost:8080/","height":113,"referenced_widgets":["2f943c0859294f1996ad7446d59f9875","5c49585ec04b4e959982da7fa03c9b95","b8d1018966384ba48b1a169eedf17e3c","6887223f465d4ed78b9e73f86a4c4b63","3adfd4fffe544b48b50b4930ef78b662","2bb05b51a59a402ea6e32e466ee7a942","b83fed0069ee4b3ca9bbe71042239c82","f2df3a3edf7e42499d01e93e621a89c0","121d4e9a162c4a2797c56ba5c6d71e86","b95c944996ba4c9abb1f2e4088d075f1","105d3923ec684dbf827233d47029b850","179820f6f0764af8ab1413582f4048cc","bc70b8450e034b959ee624f6b75fa3d6","5ec94cfec05746a0bccd6f82ad4c1c85","23f577fd22ee41d59bf092508073021a","54717c8413a942c48e2cb291534261e0","80e716264d644641b2d13056b2a38126","d7ebc157aaae49669c7533ebee031593","94f36e0156e54f24aed2a7ea20f85d5d","7d88b19ad73c4037924284b4bc46b641","9c3c18998b034acaba202634c7dc7fd3","e042abad39d34daaaf3e7b939d360641","f9be60d9eb534f50bda80f7ef7da90c3","86b85dbf44fa4b9d8912a0b36863d5ce","719c951928544d039d1fda28bac198ab","f594185c6e814986bb3c37219ba9b1c1","fef2ec84633d43939435963de8dff140","aeb729c9a3f34e39ac3002135b42e02e","dc917ddda459402d95bb7f714b2b403b","4dd0f6e187084367b49062dec1889cfa","b27d4b0474c642f287e04cd4740e9fd5","37b3e1a2d20d4722920f3f245b285198","19d677424420449484d7e45c381a8bdd"]},"executionInfo":{"status":"ok","timestamp":1674767089468,"user_tz":300,"elapsed":1003,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}},"outputId":"c194f02b-70c3-4247-eaf3-eeff845af02f"},"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)solve/main/vocab.txt:   0%|          | 0.00/232k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2f943c0859294f1996ad7446d59f9875"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)okenizer_config.json:   0%|          | 0.00/28.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"179820f6f0764af8ab1413582f4048cc"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/483 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f9be60d9eb534f50bda80f7ef7da90c3"}},"metadata":{}}],"source":["# For DistilBERT:\n","model_class, tokenizer_class, pretrained_weights = (ppb.DistilBertModel, ppb.DistilBertTokenizer, 'distilbert-base-uncased')\n","\n","## Want BERT instead of distilBERT? Uncomment the following line:\n","#model_class, tokenizer_class, pretrained_weights = (ppb.BertModel, ppb.BertTokenizer, 'bert-base-uncased')\n","\n","# TODO - figure out the above for the Q/A model. Might need a different\n","#        enough implementation/approach that it warrents a dif script. \n","#        It takes a masked input for the Q and options for multiple choice? idk. \n","\n","# Load pretrained model/tokenizer\n","tokenizer  = tokenizer_class.from_pretrained(pretrained_weights, truncate=True,)"]},{"cell_type":"markdown","metadata":{"id":"LOr21JIPpm8I"},"source":["## Creating Example Tuples"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"C7i_zEHIkb_D","executionInfo":{"status":"ok","timestamp":1674767089468,"user_tz":300,"elapsed":11,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"outputs":[],"source":["# Adds 'raw_tokens', 'num_tokens', 'token_seq', 'attn_mask' columns to the DF\n","def add_seqs_and_masks(df_in, text_col):\n","  # Tokenize\n","  df_in['raw_tokens'] = df_in[text_col].apply(lambda x: tokenizer.encode(x,\n","                                                                         max_length=MAX_SEQ_LEN,\n","                                                                         truncation=True,\n","                                                                         add_special_tokens=True))\n","\n","  def pad_seq(s):\n","    return s + [0]*(MAX_SEQ_LEN-len(s))\n","\n","  def mask_seq(s):\n","    return [0 if i == 0 else 1 for i in s]\n","\n","  df_in['num_tokens'] = df_in['raw_tokens'].apply(lambda s: len(s))\n","  df_in['token_seq']  = df_in['raw_tokens'].apply(pad_seq)\n","  df_in['attn_mask']  = df_in['token_seq'].apply(mask_seq)"]},{"cell_type":"markdown","source":["### Question/Context Embedding Dicts"],"metadata":{"id":"noOpZRP8yXpr"}},{"cell_type":"markdown","source":["These two data frames contain all the natural langauge content for the question and context strings. \n","\n","These will be used to build maps so we can quickly find the token sequence and attention mask for each individual context string and question string. This will be used later to build the individual training examples. "],"metadata":{"id":"IOoeD1gRUkyE"}},{"cell_type":"code","source":["add_seqs_and_masks(questions, 'question_text')\n","add_seqs_and_masks(contexts, 'context_text')"],"metadata":{"id":"YpveAyZ4n8d_","executionInfo":{"status":"ok","timestamp":1674767089469,"user_tz":300,"elapsed":8,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"execution_count":13,"outputs":[]},{"cell_type":"code","source":["print(contexts['token_seq'])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"z8pp0IC5y-4d","executionInfo":{"status":"ok","timestamp":1674767089671,"user_tz":300,"elapsed":208,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}},"outputId":"f7c012d6-12dd-44b9-c64f-186a58a3ae7b"},"execution_count":14,"outputs":[{"output_type":"stream","name":"stdout","text":["0    [101, 2510, 1998, 24633, 102, 0, 0, 0, 0, 0, 0...\n","1    [101, 2510, 1998, 6627, 102, 0, 0, 0, 0, 0, 0,...\n","2    [101, 2974, 1998, 9394, 102, 0, 0, 0, 0, 0, 0,...\n","3    [101, 2974, 1998, 8275, 2739, 102, 0, 0, 0, 0,...\n","4    [101, 1996, 8798, 1997, 3533, 7226, 2368, 102,...\n","5    [101, 1996, 12353, 1997, 28896, 1012, 102, 0, ...\n","Name: token_seq, dtype: object\n"]}]},{"cell_type":"code","execution_count":15,"metadata":{"id":"35ukWIxGuq_t","executionInfo":{"status":"ok","timestamp":1674767089672,"user_tz":300,"elapsed":19,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"38d90829-3f69-41b1-d140-db0306838954"},"outputs":[{"output_type":"stream","name":"stdout","text":["\n"]}],"source":["map_q_2_ts_am = dict()\n","def build_q_map(row):\n","  global map_q_emb\n","  map_q_2_ts_am[row['question_id']] = [torch.tensor(row['token_seq']), \n","                                       torch.tensor(row['attn_mask'])]\n","\n","map_ctx_2_ts_am = dict()\n","def build_ctx_map(row):\n","  global map_ctx_emb\n","  map_ctx_2_ts_am[row['context_id']] = [torch.tensor(row['token_seq']), \n","                                        torch.tensor(row['attn_mask'])]\n","\n","\n","questions.apply(build_q_map, axis=1)\n","contexts.apply(build_ctx_map, axis=1)\n","print(\"\")"]},{"cell_type":"markdown","source":["### Balancing - Over-Sampling Method"],"metadata":{"id":"Ee2A1EDh0Zgd"}},{"cell_type":"code","source":["def max_size_oversampling_wr(examples):\n","  question_counts = dict()\n","  context_counts  = dict()\n","  \n","  for _, _, _, _, ctx, q in examples:\n","    if q not in question_counts:\n","      question_counts[q] = 0\n","    question_counts[q] += 1\n","    \n","    if ctx not in context_counts:\n","      context_counts[ctx] = 0\n","    context_counts[ctx] += 1\n","\n","  context_examples    = { k: [] for k in context_counts}\n","  context_populations = { k: [] for k in context_counts}\n","\n","  for tsam_ctx, tsam_q, tsam_cnt, y, ctx, q in examples:\n","    context_populations[ctx].append([tsam_ctx, tsam_q, tsam_cnt, y])\n","\n","  max_size = 0\n","  for k in context_populations:\n","    size_pop = len(context_populations[k])\n","    if size_pop > max_size:\n","      max_size = size_pop\n","\n","  for k in context_examples:\n","    while len(context_examples[k]) < max_size:\n","      context_examples[k].append(random.sample(context_populations[k], 1)[0])\n","\n","  example_tuples_max_sampled = []\n","  for k in context_examples:\n","    for ex in context_examples[k]:\n","      example_tuples_max_sampled.append(ex)\n","  return example_tuples_max_sampled"],"metadata":{"id":"g8b-jBO3zaM9","executionInfo":{"status":"ok","timestamp":1674767089672,"user_tz":300,"elapsed":15,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"execution_count":16,"outputs":[]},{"cell_type":"markdown","source":["### Tuple Generation Method"],"metadata":{"id":"7EFQMMop0fyz"}},{"cell_type":"markdown","source":["This is the main method we call to turn a dataframe of content into a split and balanced set of training/test data. "],"metadata":{"id":"1sI_DhK5yo0A"}},{"cell_type":"code","source":["def make_example_tuples(df_content, balance=True):\n","  add_seqs_and_masks(df_content, 'content_text')\n","\n","  content_example_tuples = []\n","  \n","  def make_make_tuple(out_list):\n","    def make_tuple(row):\n","      out_list.append([\n","          map_q_2_ts_am[row['question_id']],\n","          map_ctx_2_ts_am[row['context_id']],\n","          [torch.tensor(row['token_seq']), torch.tensor(row['attn_mask'])],\n","          row['answer'],\n","          row['context_id'],\n","          row['question_id']\n","      ])\n","    return make_tuple\n","\n","  df_content.apply(make_make_tuple(content_example_tuples), axis=1)\n","\n","  if balance:\n","    return max_size_oversampling_wr(content_example_tuples)\n","  else:\n","    return content_example_tuples"],"metadata":{"id":"at-9T_v0h60u","executionInfo":{"status":"ok","timestamp":1674767089673,"user_tz":300,"elapsed":14,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"execution_count":17,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"RB2B2S8mPFxJ"},"source":["## Test-Train Split, Batching"]},{"cell_type":"code","source":["def create_batch(tuples):\n","  q_tensors   = [i[0][0] for i in tuples]\n","  q_attn_m    = [i[0][1] for i in tuples]\n","  ctx_tensors = [i[1][0] for i in tuples]\n","  ctx_attn_m  = [i[1][1] for i in tuples] \n","  cnt_tensors = [i[2][0] for i in tuples]\n","  cnt_attn_m  = [i[2][1] for i in tuples]\n","\n","  x_tensors = [[torch.stack(q_tensors),   torch.stack(q_attn_m)],\n","               [torch.stack(ctx_tensors), torch.stack(ctx_attn_m)],\n","               [torch.stack(cnt_tensors), torch.stack(cnt_attn_m)]]\n","\n","  y_tensor = torch.tensor([i[3] for i in tuples], dtype=torch.float)\n","  y_tensor = torch.reshape(y_tensor, (-1, 1))\n","\n","  return x_tensors, y_tensor"],"metadata":{"id":"_qcWGF7Hqbr2","executionInfo":{"status":"ok","timestamp":1674767089673,"user_tz":300,"elapsed":11,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"execution_count":18,"outputs":[]},{"cell_type":"code","execution_count":19,"metadata":{"id":"FKixJD1p8kTY","executionInfo":{"status":"ok","timestamp":1674767089674,"user_tz":300,"elapsed":10,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"outputs":[],"source":["def create_test_train_batches(tuples, test_frac=TEST_FRAC, batch_size=BATCH_SIZE):\n","  NUM_TRAIN = int((1-test_frac)*len(tuples))\n","\n","  if test_frac == 0:\n","    train_tuples = tuples\n","    test_tuples = None\n","  else:\n","    train_tuples = tuples[:NUM_TRAIN]\n","    test_tuples  = tuples[NUM_TRAIN:]\n","\n","\n","  if batch_size == -1:\n","    batch_size = NUM_TRAIN\n","\n","  training_batches = [train_tuples[i:i+batch_size] for i in range(int(NUM_TRAIN/batch_size))]\n","  training_stacked = []\n","  for batch in training_batches:\n","    training_stacked.append(create_batch(batch))\n","\n","  if test_frac == 0:\n","    testing_stacked = None\n","  else:\n","    NUM_TEST = len(test_tuples)\n","    testing_batches = [test_tuples[i:i+batch_size] for i in range(int(NUM_TEST/batch_size))]\n","    testing_stacked = []\n","    for batch in testing_batches:\n","      testing_stacked.append(create_batch(batch))\n","\n","  return training_stacked, testing_stacked"]},{"cell_type":"markdown","source":["# Training/Evaluation Setup"],"metadata":{"id":"8FoP5ForAtkE"}},{"cell_type":"markdown","metadata":{"id":"rPCF7MZNzOAT"},"source":["## Model Implementation"]},{"cell_type":"code","execution_count":20,"metadata":{"id":"UYqqeGe8zVd8","executionInfo":{"status":"ok","timestamp":1674767091316,"user_tz":300,"elapsed":9,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"outputs":[],"source":["import torch.nn.functional as F\n","from torch.nn import Module, RNN, Linear, BCELoss, LogSoftmax, BatchNorm1d\n","\n","NUM_BERT_FEATURES = 768\n","\n","HL_QUESTION = 32\n","HL_CONTEXTS = 32\n","HL_CONTENT  = 32\n","HL_PRED = 8\n","\n","class AQAM(torch.nn.Module):\n","    def __init__(self):\n","        super().__init__()\n","\n","        # Transformer Embedding Layer\n","        self.bert_layer = model_class.from_pretrained(pretrained_weights)\n","\n","        # 3 MLP Stacks\n","        self.q_linear1   = Linear(NUM_BERT_FEATURES, HL_QUESTION)\n","        self.ctx_linear1 = Linear(NUM_BERT_FEATURES, HL_CONTEXTS)\n","        self.content_linear1 = Linear(NUM_BERT_FEATURES, HL_CONTENT)\n","        \n","        # Prediction Layers\n","        self.pred_linear1 = Linear(HL_QUESTION+HL_CONTEXTS+HL_CONTENT, HL_PRED)\n","        self.pred_linear2 = Linear(HL_PRED, 1)\n","\n","        # Batch Norms\n","        self.bn_q    = BatchNorm1d(HL_QUESTION)\n","        self.bn_ctx  = BatchNorm1d(HL_CONTEXTS)\n","        self.bn_cnt  = BatchNorm1d(HL_CONTENT) \n","\n","        # self.bn_triple = BatchNorm1d(HL_QUESTION+HL_CONTEXTS+HL_CONTENT)\n","        self.bn_cat  = BatchNorm1d(HL_PRED) \n","\n","    def forward(self, data):\n","        tok_seq_q,   attn_mask_q   = data[0]\n","        tok_seq_ctx, attn_mask_ctx = data[1]\n","        tok_seq_cnt, attn_mask_cnt = data[2]\n","\n","        emb_q   = self.bert_layer(tok_seq_q, \n","                                  attention_mask=attn_mask_q, \n","                                  output_attentions=False,\n","                                  output_hidden_states=False, \n","                                  return_dict=False)[0][:, 0, :]\n","\n","        emb_ctx = self.bert_layer(tok_seq_ctx,\n","                                  attention_mask=attn_mask_ctx, \n","                                  output_attentions=False,\n","                                  output_hidden_states=False, \n","                                  return_dict=False)[0][:, 0, :]\n","\n","        emb_cnt = self.bert_layer(tok_seq_cnt, \n","                                  attention_mask=attn_mask_cnt, \n","                                  output_attentions=False,\n","                                  output_hidden_states=False, \n","                                  return_dict=False)[0][:, 0, :]\n","\n","        # The 3 Heads - Question, Context, Content spaces.\n","        ls_q   = self.q_linear1(emb_q)\n","        ls_q   = self.bn_q(ls_q)\n","        ls_q   = F.relu(ls_q)\n","\n","        ls_ctx = self.ctx_linear1(emb_ctx)\n","        ls_ctx = self.bn_ctx(ls_ctx)\n","        ls_ctx = F.relu(ls_ctx)\n","        \n","        ls_cnt = self.content_linear1(emb_cnt)\n","        ls_cnt = self.bn_cnt(ls_cnt)\n","        ls_cnt = F.relu(ls_cnt)\n","\n","        ls_cat = torch.cat((ls_q, ls_ctx, ls_cnt), dim=1)\n","        \n","        # Prediction Layers\n","        ls_cat = self.pred_linear1(ls_cat)\n","        ls_cat = self.bn_cat(ls_cat)\n","        ls_cat = F.relu(ls_cat)\n","        return self.pred_linear2(ls_cat)"]},{"cell_type":"markdown","metadata":{"id":"h6ilu9ax8bze"},"source":["## Training and Evaluation Method"]},{"cell_type":"code","execution_count":21,"metadata":{"id":"f2D3fYj89Bpz","executionInfo":{"status":"ok","timestamp":1674767091317,"user_tz":300,"elapsed":8,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"outputs":[],"source":["from torch.optim import SGD"]},{"cell_type":"code","execution_count":22,"metadata":{"id":"MaoTTbX0BfNN","executionInfo":{"status":"ok","timestamp":1674767091317,"user_tz":300,"elapsed":7,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"outputs":[],"source":["def binary_acc(y_pred, y_test):\n","  # Where we handle the sigmoid for the BC\n","  y_pred_tag = torch.round(torch.sigmoid(y_pred))\n","  correct_results_sum = (y_pred_tag == y_test).sum().float()\n","  acc = correct_results_sum/float(y_test.shape[0])\n","  return acc"]},{"cell_type":"code","source":["def send_batch(batch, device):\n","  for i in range(3):\n","    batch[i][0] = batch[i][0].to(device)\n","    batch[i][1] = batch[i][1].to(device)\n","\n","def send_batches(batches, device):\n","  for batch, _ in batches:\n","    for i in range(3):\n","      batch[i][0] = batch[i][0].to(device)\n","      batch[i][1] = batch[i][1].to(device)"],"metadata":{"id":"fIBgdiZR-qvl","executionInfo":{"status":"ok","timestamp":1674767091319,"user_tz":300,"elapsed":8,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"execution_count":23,"outputs":[]},{"cell_type":"code","execution_count":24,"metadata":{"id":"ynT43r7n9s2P","executionInfo":{"status":"ok","timestamp":1674767091320,"user_tz":300,"elapsed":8,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"outputs":[],"source":["def train_and_evaluate(training_batches, test_set_batches, epochs, cuda_dev, model=None):\n","  if model is None:\n","    model = AQAM().to(cuda_dev)\n","  \n","  optimizer = SGD(model.parameters(), lr=0.001, momentum=0.9)\n","  criterion = torch.nn.BCEWithLogitsLoss().to(cuda_dev)\n","\n","  train_accs = []\n","  test_accs  = [[] for _ in test_set_batches]\n","  for epoch in tqdm(range(epochs), unit=\"epoch\"):\n","    model.train()\n","    optimizer.zero_grad()\n","    \n","    # Resample batches\n","\n","    batch_accs = []\n","    for batch, labels in training_batches:\n","      send_batch(batch, cuda_dev)\n","      labels = labels.to(cuda_dev)\n","\n","      out = model(batch)\n","      loss = criterion(out, labels)\n","      loss.backward()\n","      optimizer.step()\n","      batch_accs.append(binary_acc(out, labels))\n","\n","      del batch\n","      del labels\n","\n","    train_accs.append(sum(batch_accs)/float(len(batch_accs)))\n","\n","    model.eval()\n","    for t_idx, test_batches in enumerate(test_set_batches):\n","      test_batch_accs = []\n","      for test_batch, test_labels in test_batches:\n","        send_batch(test_batch, cuda_dev)\n","        test_labels = test_labels.to(cuda_dev)\n","\n","        test_out = model(test_batch)\n","        test_labels = test_labels.to(cuda_dev)\n","                \n","        test_batch_accs.append(binary_acc(test_out, test_labels))\n","        \n","        del test_batch\n","        del test_labels\n","      \n","      test_accs[t_idx].append(sum(test_batch_accs)/float(len(test_batch_accs)))\n","\n","  return train_accs, test_accs, model"]},{"cell_type":"markdown","source":["# Experiment\n"],"metadata":{"id":"0EEfqSGktDTk"}},{"cell_type":"markdown","source":["Here we want to see the impact on the baseline model. The following code is taken from the AQA 05 script. \n","\n","We know this ran using the data shape and model, so any errors should just be due to our changes to support fine-tuning. "],"metadata":{"id":"awiZgm9atGTa"}},{"cell_type":"code","source":["bal_exs_A3_majplus = make_example_tuples(content_a3_majplus)\n","random.shuffle(bal_exs_A3_majplus)\n","a3_mp_ttbs = create_test_train_batches(bal_exs_A3_majplus)\n","a3_mp_train_batches, a3_mp_test_batches = a3_mp_ttbs\n","\n","# Treat A2-FA data as the A2 test data. Already have this. \n","# We want to create a validation set, so lets divide the A2-FA data\n","# into two sets of data. We'll use one to train, and one to validate\n","# across all the experiments. 50/50 seems good?\n","test_exs_A2_fa = make_example_tuples(content_a2_fa, balance=False)\n","random.shuffle(test_exs_A2_fa)\n","a2_fa_ttbs = create_test_train_batches(test_exs_A2_fa,\n","                                       test_frac=0.5)\n","a2_fa_train_batches, a2_fa_test_batches = a2_fa_ttbs\n","\n","# train/eval A3-model on A3 Maj+ training data\n","#   - Pass in A3 test data\n","#   - Pass in A2-FA test data - Does it agree with the FA?\n","test_batches = [\n","  a3_mp_test_batches,\n","  a2_fa_test_batches\n","]"],"metadata":{"id":"amd9rLV6tLhg","executionInfo":{"status":"ok","timestamp":1674767099823,"user_tz":300,"elapsed":6031,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"execution_count":25,"outputs":[]},{"cell_type":"code","source":["print(torch.cuda.get_device_name(0))\n","cuda_name = torch.cuda.get_device_name(0)\n","cuda_dev  = torch.device(\"cuda:0\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7NbZSkMC9NR1","executionInfo":{"status":"ok","timestamp":1674767100578,"user_tz":300,"elapsed":161,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}},"outputId":"58bab8f7-d030-407c-8067-740a23d7dc04"},"execution_count":26,"outputs":[{"output_type":"stream","name":"stdout","text":["NVIDIA A100-SXM4-40GB\n"]}]},{"cell_type":"code","source":["train_acc_pre, test_accs_pre, a3_model = train_and_evaluate(a3_mp_train_batches, \n","                                                            test_batches,\n","                                                            EPOCHS,\n","                                                            cuda_dev)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":153,"referenced_widgets":["557bab4cebd445f9a347b5f9f85e8e91","6291af4dc6d0464f8134a61d5c015cd9","6f08df3f02984f0183c51de3310b1574","64a99dd2253c47db941a4fb4559e0d71","146e23d91d4c4076b45255bc5df69b72","c012b83969874e99a322629837530dbb","805e5a5e937843ad9988b57853b235c9","554b3236be944ae2b6ac720bc6987ca3","7e3a65b7d4a14f4cb3f05234739608cd","d2a9eb758dad44ebb50b84adabf1fc81","524351ac728d4c6a8cc5bb8a6701ee41","648ff2a4b4b840bcb7129368ef3140b9","88f7146f4d574bc5a6b40446e12579e5","51381d31a49c47aa842522be68ba4338","1e5dcfd07a9f4efdb2a241a0a3d1066b","e3d9b69995bc4526836ce2b2ac4784fe","ed49d4e1960448dcaab2d1b6d1ebdfe8","183d90021b6e4973bb875aa9b653becf","1ece6f4e46774b6dbd57ba67bf49989d","02c9083835b344f3a8f3f401ebebc066","7570902ff9b64e00adc1bb8b81d4aad7","e4b2a5b122bf4c25b0790440b061043e"]},"id":"B8MVOM5m3SZE","executionInfo":{"status":"ok","timestamp":1674770305557,"user_tz":300,"elapsed":3204994,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}},"outputId":"27e46f19-9597-4fd8-85c8-024e80a9c394"},"execution_count":27,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)\"pytorch_model.bin\";:   0%|          | 0.00/268M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"557bab4cebd445f9a347b5f9f85e8e91"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at distilbert-base-uncased were not used when initializing DistilBertModel: ['vocab_layer_norm.bias', 'vocab_layer_norm.weight', 'vocab_projector.bias', 'vocab_transform.weight', 'vocab_transform.bias', 'vocab_projector.weight']\n","- This IS expected if you are initializing DistilBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing DistilBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/100 [00:00<?, ?epoch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"648ff2a4b4b840bcb7129368ef3140b9"}},"metadata":{}}]},{"cell_type":"code","source":["with open(f\"{RESULTS_FN_SLUG}_EXP00.p\", 'wb') as f:\n","  pickle.dump(test_accs_pre, f)\n","\n","upload_file_to_gcs(f\"{RESULTS_FN_SLUG}_EXP00.p\", f\"{RESULTS_FN_SLUG}_EXP00.p\")"],"metadata":{"id":"Do3zAN43816w","executionInfo":{"status":"ok","timestamp":1674770307670,"user_tz":300,"elapsed":2138,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"execution_count":28,"outputs":[]},{"cell_type":"markdown","source":["#### Results - Baseline Epoch Losses"],"metadata":{"id":"xmQldHMTWfl-"}},{"cell_type":"markdown","source":["Here we just want to see the per-epoch training and test losses. We have multiple sets of test data to consider (2 for now). Need a graph that shows all 3 lines. \n","\n","This will give a baseline to compare against when we look at the effect of online training the model later (EXP1)."],"metadata":{"id":"LD0tWMduZFiK"}},{"cell_type":"code","source":["import matplotlib.pyplot as plt\n","%matplotlib notebook\n","%matplotlib inline"],"metadata":{"id":"Uo-1hODT9H9A","executionInfo":{"status":"ok","timestamp":1674770307673,"user_tz":300,"elapsed":25,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}}},"execution_count":29,"outputs":[]},{"cell_type":"code","source":["cutoff = 100\n","labels = [\"A3 Maj+\", \"A2 FA\"]\n","colors = [\"tab:green\", \"tab:blue\"]\n","\n","for l, test, color in zip(labels, test_accs_pre, colors):\n","\n","  test = [i.cpu() for i in test]\n","  plt.plot(test[:cutoff], label=f\"{l}\", color=color)\n","\n","plt.title(\"Baseline Model Test Acc's\")\n","plt.legend(loc='lower left')\n","plt.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":281},"id":"2gIe1FpyWd8f","executionInfo":{"status":"ok","timestamp":1674770822274,"user_tz":300,"elapsed":486,"user":{"displayName":"Bill Power","userId":"17299628813846429758"}},"outputId":"0a074488-7950-4120-ea8e-ad1715cb41b9"},"execution_count":31,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"markdown","source":["Ouch. Need to iterate. That's a rough curve. Do I really need the CLS and SEP tokens for this LM? I think they were needed for the full BERT, but I thought DistillBERT let me get away without them? I should ping Jumanah to see if she has a better idea. "],"metadata":{"id":"bqX6nTzfJFHK"}}]}